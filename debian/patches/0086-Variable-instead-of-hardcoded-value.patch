From: "Igor B. Poretsky" <poretsky@rakurs.com>
Date: Fri, 25 Nov 2022 14:48:02 +0300
Subject: Variable instead of hardcoded value

---
 lisp/emacspeak-forms.el | 13 +++++++++++--
 lisp/emacspeak-speak.el |  2 +-
 2 files changed, 12 insertions(+), 3 deletions(-)

diff --git a/lisp/emacspeak-forms.el b/lisp/emacspeak-forms.el
index a63bb26..02dd44d 100644
--- a/lisp/emacspeak-forms.el
+++ b/lisp/emacspeak-forms.el
@@ -58,6 +58,10 @@
 ;;}}}
 ;;{{{ Helper functions
 
+(defvar emacspeak-forms-directory
+  (expand-file-name "forms/" emacspeak-etc-directory)
+  "Directory where forms are stored.")
+
 (defvar emacspeak-forms-current-record-summarizer
   'emacspeak-forms-speak-field
   "Summarizer function for summarizing a record. Default is to
@@ -248,8 +252,13 @@ Assumes that point is at the front of a field value."
   "Visit a forms file"
   (interactive
    (list
-    (read-file-name "Forms file: "
-                    (expand-file-name "forms/" emacspeak-etc-directory))))
+    (let ((insert-default-directory nil))
+      (expand-file-name
+       (read-file-name "Forms file: "
+                       emacspeak-forms-directory nil t nil
+                       '(lambda (name)
+                          (string-match "\\.el$" name)))
+       emacspeak-forms-directory))))
   (forms-find-file filename))
 
 ;;}}}
diff --git a/lisp/emacspeak-speak.el b/lisp/emacspeak-speak.el
index de2b908..f083a4e 100644
--- a/lisp/emacspeak-speak.el
+++ b/lisp/emacspeak-speak.el
@@ -472,7 +472,7 @@ Useful to do this before you listen to an entire buffer."
   "Set punctuation mode for all buffers in current mode."
   (interactive
    (list
-    (intern (completing-read "Punctuation Mode: " '(all none some)))))
+    (intern (completing-read "Punctuation Mode: " dtk-punctuation-mode-alist nil t))))
   (cl-declare (special major-mode))
   (ems-set-mode-punctuation-setting major-mode setting)
   (ems-sync-mode-punctuation-setting major-mode)
