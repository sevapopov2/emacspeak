From: "Igor B. Poretsky" <poretsky@rakurs.com>
Date: Fri, 25 Nov 2022 14:43:17 +0300
Subject: Shell command helper enhancement

Arguments can be specified as well.
---
 lisp/emacspeak-dired.el   | 2 +-
 lisp/emacspeak-speak.el   | 8 +++++---
 lisp/emacspeak-wizards.el | 7 +++----
 3 files changed, 9 insertions(+), 8 deletions(-)

diff --git a/lisp/emacspeak-dired.el b/lisp/emacspeak-dired.el
index 686daa9..d1afd6e 100644
--- a/lisp/emacspeak-dired.el
+++ b/lisp/emacspeak-dired.el
@@ -443,7 +443,7 @@ On a directory line, run du -s on the directory to speak its size."
      ((and filename
            (file-directory-p filename))
       (emacspeak-auditory-icon 'progress)
-      (emacspeak-shell-command (format "du -s \"%s\"" filename)))
+      (emacspeak-shell-command "du" "-s" filename ))
      (filename
       (setq size (nth 7 (file-attributes filename)))
                                         ; check for ange-ftp
diff --git a/lisp/emacspeak-speak.el b/lisp/emacspeak-speak.el
index 451b657..a80fbfa 100644
--- a/lisp/emacspeak-speak.el
+++ b/lisp/emacspeak-speak.el
@@ -204,8 +204,8 @@ message area.  You can use command
 ;;; This replacement is used within Emacspeak to invoke commands
 ;;; whose output we want to hear.
 
-(defun emacspeak-shell-command (command)
-  "Run shell command COMMANDAND speak its output."
+(defun emacspeak-shell-command (command &rest args)
+  "Run shell command COMMAND and speak its output."
   (interactive "sCommand:")
   (cl-declare (special default-directory))
   (let ((directory default-directory)
@@ -214,7 +214,9 @@ message area.  You can use command
       (erase-buffer)
       (setq default-directory directory)
       (ems-with-messages-silenced
-       (shell-command command output))
+       (if args
+           (apply 'call-process command nil output nil args)
+         (shell-command command output)))
       (emacspeak-auditory-icon 'open-object)
       (dtk-speak (buffer-string)))))
 
diff --git a/lisp/emacspeak-wizards.el b/lisp/emacspeak-wizards.el
index 6d7a4eb..69a4497 100644
--- a/lisp/emacspeak-wizards.el
+++ b/lisp/emacspeak-wizards.el
@@ -363,10 +363,9 @@ With prefix arg, opens the phone book for editing."
     (emacspeak-auditory-icon 'open-object))
    ((file-exists-p emacspeak-speak-telephone-directory)
     (emacspeak-shell-command
-     (format "%s %s %s"
-             emacspeak-speak-telephone-directory-command
-             (read-from-minibuffer "Lookup number for: ")
-             emacspeak-speak-telephone-directory))
+     emacspeak-speak-telephone-directory-command
+     (read-from-minibuffer "Lookup number for: ")
+     emacspeak-speak-telephone-directory)
     (emacspeak-speak-message-again))
    (t (error "First create your phone directory in %s"
              emacspeak-speak-telephone-directory))))
