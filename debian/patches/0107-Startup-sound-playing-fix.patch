From: "Igor B. Poretsky" <poretsky@mlbox.ru>
Date: Sat, 26 Nov 2022 08:00:49 +0300
Subject: Startup sound playing fix

---
 lisp/emacspeak-speak.el | 11 +++--------
 lisp/emacspeak.el       |  7 +++++--
 2 files changed, 8 insertions(+), 10 deletions(-)

diff --git a/lisp/emacspeak-speak.el b/lisp/emacspeak-speak.el
index 51cb98c..22e854b 100644
--- a/lisp/emacspeak-speak.el
+++ b/lisp/emacspeak-speak.el
@@ -2228,15 +2228,10 @@ Seconds value is also placed in the kill-ring."
   "Announce version information for running emacspeak.
 Optional interactive prefix arg `speak-rev' speaks only the Git revision number."
   (interactive "P")
-  (cl-declare (special emacspeak-version emacspeak-sounds-directory
-                       emacspeak-use-auditory-icons))
+  (cl-declare (special emacspeak-version emacspeak-use-auditory-icons))
   (let ((signature "Emacspeak "))
-    (when
-        (and (null speak-rev) emacspeak-use-auditory-icons
-             (executable-find "mplayer"))
-      (start-process
-       "mp3" nil "mplayer"
-       (expand-file-name "emacspeak.mp3" emacspeak-sounds-directory)))
+    (when  emacspeak-use-auditory-icons
+      (emacspeak-play-startup-icon))
     (tts-with-punctuations
      'some
      (dtk-speak-and-echo
diff --git a/lisp/emacspeak.el b/lisp/emacspeak.el
index 66a1cac..df7d9c9 100644
--- a/lisp/emacspeak.el
+++ b/lisp/emacspeak.el
@@ -449,16 +449,19 @@ caps."
   "If set to T, emacspeak plays its icon as it launches."
   :type 'boolean
   :group 'emacspeak)
+
 (defsubst emacspeak-play-startup-icon ()
   "Play startup icon if requested."
   (cl-declare (special emacspeak-play-emacspeak-startup-icon))
-  (let ((player  (or (executable-find "mplayer")
-                     (executable-find "play"))))
+  (let ((player  (or (executable-find "mpg123")
+                     (executable-find "mpg321")
+                     (executable-find "mplayer"))))
     (when (and  emacspeak-play-emacspeak-startup-icon player)
       (start-process
        "mp3" nil
        player
        (expand-file-name "emacspeak.mp3" emacspeak-sounds-directory)))))
+
 ;;;###autoload
 (defun emacspeak()
   "Start the Emacspeak Audio Desktop.
